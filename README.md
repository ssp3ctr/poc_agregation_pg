# üì¶ Warehouse Stock and Status Tracker

## üìã –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∫–ª–∞–¥—Å–∫–∏–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ —Å —É—á—ë—Ç–æ–º:
- –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ —Å–∫–ª–∞–¥–∞–º
- –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –æ—Å—Ç–∞—Ç–∫–æ–≤
- –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ —Ç–æ–≤–∞—Ä–∞ (–¥–æ—Å—Ç—É–ø–µ–Ω / –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è / –∑–∞–∫–æ–Ω—á–∏–ª—Å—è)
- –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å—á—ë—Ç—á–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–æ–≤
- —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ (—á–µ—Ä–µ–∑ PostgreSQL `LISTEN/NOTIFY`)

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/your-org/warehouse-tracker.git
cd warehouse-tracker

# –°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
echo "DATABASE_URL=postgresql+asyncpg://user:password@db:5432/warehouse_db" > .env

# –°–æ–±–µ—Ä–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç
docker compose up --build
```

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ FastAPI –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:  
üëâ http://localhost:8000

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Swagger:  
üìö http://localhost:8000/docs

## üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **PostgreSQL**: —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö + –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —á–µ—Ä–µ–∑ —Ç—Ä–∏–≥–≥–µ—Ä—ã
- **FastAPI**: API-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ –∏ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å—á—ë—Ç—á–∏–∫–∞
- **SQLAlchemy (async)**: —Ä–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π
- **asyncpg + pg_notify**: —Ä–µ–∞–ª—Ç–∞–π–º-—Å–ª—É—à–∞—Ç–µ–ª—å –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–∞
- **–¢—Ä–∏–≥–≥–µ—Ä—ã**:
  - `update_stock_and_status`: –æ–±–Ω–æ–≤–ª—è–µ—Ç –æ—Å—Ç–∞—Ç–∫–∏ –∏ —Å—Ç–∞—Ç—É—Å
  - `notify_status_change`: –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á—ë—Ç—á–∏–∫

–î–ª—è –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω —Å–∫—Ä–∏–ø—Ç
```bash
docker compose exec app python setup_db.py
```

–°–æ–∑–¥–∞–µ—Ç 500 —Ç—ã—Å –∑–∞–ø–∏—Å–µ–π –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–∏–≥–µ—Ä—è—Ç –ø—Ä–æ—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏ —Å—Ç–∞—Ç—É—Å–æ–≤ (–º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ)

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü

| –¢–∞–±–ª–∏—Ü–∞                | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                             |
|------------------------|----------------------------------------|
| `warehouse_operations` | –û–ø–µ—Ä–∞—Ü–∏–∏ –¥–≤–∏–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞               |
| `stock_balance`        | –û—Å—Ç–∞—Ç–∫–∏ –ø–æ –∫–∞–∂–¥–æ–º—É —Å–∫–ª–∞–¥—É              |
| `products_status`      | –°—Ç–∞—Ç—É—Å—ã —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ —Å–∫–ª–∞–¥–∞–º             |
| `status_change_counter`| –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Å—á—ë—Ç—á–∏–∫ —Å–º–µ–Ω—ã —Å—Ç–∞—Ç—É—Å–æ–≤      |

## üì° –ü—Ä–∏–º–µ—Ä—ã API

```http
GET /balances
```
–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –æ—Å—Ç–∞—Ç–∫–∏.

```http
GET /balances/product/{product_id}
```
–û—Å—Ç–∞—Ç–∫–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ –≤—Å–µ—Ö —Å–∫–ª–∞–¥–∞—Ö.

```http
GET /balances/warehouse/{warehouse_id}
```
–û—Å—Ç–∞—Ç–∫–∏ –ø–æ —Å–∫–ª–∞–¥—É.

```http
GET /balances/product/{product_id}/warehouse/{warehouse_id}
```
–û—Å—Ç–∞—Ç–æ–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —Å–∫–ª–∞–¥–µ.

```http
GET /status-change-count
```
–¢–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–æ–≤.

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "status_changes": 1729
}
```

## üì¶ –ü—Ä–∏–º–µ—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

```
üõ∞Ô∏è –°–ª—É—à–∞—é –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤...
üîî –°—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–∏–ª—Å—è: —Ç–æ–≤–∞—Ä 3 (—Å–∫–ª–∞–¥ 5): –ó–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è ‚Üí –î–æ—Å—Ç—É–ø–µ–Ω
üîî –°—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–∏–ª—Å—è: —Ç–æ–≤–∞—Ä 7 (—Å–∫–ª–∞–¥ 2): –î–æ—Å—Ç—É–ø–µ–Ω ‚Üí –ó–∞–∫–æ–Ω—á–∏–ª—Å—è
```

## üìå –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

- WebSocket –∏–ª–∏ Kafka-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–∞ —Ñ—Ä–æ–Ω—Ç
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –î–∞—à–±–æ—Ä–¥ —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ –∏ –æ—Ç—á—ë—Ç–∞–º–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ä–æ–ª–µ–π

---

–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é. üöÄ
